<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitácora Diaria - Maxito</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
:root {
    --rojo-suave: #E9584D;
    --rojo-suave-hover: #d64439;
    --casi-negro: #232323;
    --negro: #000000;
    --gris-apple: #181818;
    --borde-apple: #222;
    --sombra-apple: 0 8px 32px rgba(0,0,0,0.35);
    --white-soft: #fafafd;
}

body {
    background: var(--negro);
    color: var(--white-soft);
    font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    min-height: 100vh;
    margin: 0;
}

/* Container principal, look Apple Card */
.container-custom {
    background: var(--gris-apple);
    border-radius: 28px;
    box-shadow: var(--sombra-apple);
    padding: 2rem 1.5rem;
    margin: 0 0.5rem;
    max-width: 420px;
    border: 1.5px solid var(--borde-apple);
    /* Efecto glassy ligero */
    backdrop-filter: blur(6px);
}

/* Títulos y cabeceras */
h1, .apple-title {
    font-size: 2.1rem;
    font-weight: 700;
    letter-spacing: -0.01em;
    margin-bottom: 0.4em;
}

.apple-sub {
    font-size: 1.1rem;
    color: #d8d8d8;
    margin-bottom: 1.5em;
    font-weight: 400;
}

/* Inputs, radios, select, textarea */
.form-input,
select,
textarea {
    background: rgba(255,255,255,0.03);
    border: 1.5px solid var(--borde-apple);
    color: var(--white-soft);
    border-radius: 14px;
    padding: 0.85em 1em;
    font-size: 1.1em;
    margin-bottom: 0.8em;
    width: 100%;
    transition: border 0.2s;
    font-weight: 500;
}

.form-input:focus,
select:focus,
textarea:focus {
    border: 1.5px solid var(--rojo-suave);
    outline: none;
}

input[type="range"] {
    width: 100%;
    accent-color: var(--rojo-suave);
    margin-top: 0.2em;
}

input[type="radio"].checkbox-custom {
    width: 1.3em;
    height: 1.3em;
    accent-color: var(--rojo-suave);
    margin-right: 0.7em;
}

label {
    font-weight: 500;
    color: #e4e4e7;
    margin-bottom: 0.3em;
}

.block {
    display: block;
}

/* Botón Apple-Like */
.btn-primary {
    width: 100%;
    background: linear-gradient(90deg, var(--rojo-suave), #ff6a57 90%);
    box-shadow: 0 2px 8px rgba(233,88,77,0.13);
    border: none;
    color: #fff;
    font-size: 1.18em;
    font-weight: 600;
    border-radius: 18px;
    padding: 1em 0;
    margin-top: 1.2em;
    margin-bottom: 0.5em;
    letter-spacing: 0.02em;
    transition: background 0.2s, transform 0.1s;
}

.btn-primary:active {
    background: var(--rojo-suave-hover);
    transform: scale(0.98);
}

.btn-primary:focus {
    outline: 2px solid #fff2;
}

#energia-value {
    font-weight: 700;
    color: var(--rojo-suave);
    font-size: 1.2em;
    margin: 0 0.5em;
}

/* Reward Section */
.photo-container {
    border-radius: 18px;
    overflow: hidden;
    box-shadow: 0 8px 28px rgba(233,88,77,0.20);
    margin-bottom: 1.5em;
}

#reward-photo {
    width: 100%;
    display: block;
    border-radius: 16px;
}

/* Animaciones suaves */
.fade-in {
    animation: fadeInUp 0.7s cubic-bezier(.33,.73,.66,.3);
}
@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(32px);}
    to   { opacity: 1; transform: translateY(0);}
}

.loading {
    display: inline-block;
    width: 26px;
    height: 26px;
    border: 4px solid rgba(255, 255, 255, 0.16);
    border-radius: 50%;
    border-top-color: var(--rojo-suave);
    animation: spin 0.85s linear infinite;
}

@keyframes spin { to { transform: rotate(360deg); } }

.success-message, .error-message {
    border-radius: 11px;
    font-weight: 500;
    padding: 0.9em 1em;
    font-size: 1.13em;
    margin-top: 0.7em;
    margin-bottom: 0.7em;
}
.success-message {
    background: rgba(40, 167, 69, 0.10);
    border: 1px solid rgba(40, 167, 69, 0.18);
    color: #2ecc71;
}
.error-message {
    background: rgba(220, 53, 69, 0.13);
    border: 1px solid rgba(220, 53, 69, 0.18);
    color: #e6584d;
}

@media (max-width: 480px) {
    .container-custom {
        padding: 1.1em 0.4em;
        border-radius: 0;
        margin: 0;
        box-shadow: none;
        min-height: 100vh;
    }
    h1, .apple-title {
        font-size: 1.5rem;
    }
    .btn-primary {
        font-size: 1em;
        padding: 0.95em 0;
        border-radius: 14px;
    }
    .photo-container {
        border-radius: 10px;
    }
}
</style>

</head>
<body class="flex items-center justify-center min-h-screen bg-black">
    <div class="container-custom">
        <!-- Página Principal -->
        <div id="main-page" class="fade-in">
            <div class="text-center mb-8">
                <h1 class="apple-title">
                    <i class="fas fa-heart text-red-400 mr-2"></i>
                    Bitácora Diaria
                </h1>
                <div class="apple-sub">
                    Maxito, tu bienestar es lo más importante.<br> Te tomará sólo 1 minuto.
                </div>
            </div>

            <form id="bitacora-form">
                <label for="horas_sueno">¿Cuántas horas dormiste anoche?</label>
                <input type="number" id="horas_sueno" name="horas_sueno" min="0" max="24" class="form-input" placeholder="Ej: 7" required>

                <label for="nivel_energia">Nivel de Energía (1-10)</label>
                <input type="range" id="nivel_energia" name="nivel_energia" min="1" max="10" value="5">
                <div class="flex justify-between items-center text-xs text-gray-400 mb-2 mt-1">
                    <span>Muy bajo</span>
                    <span id="energia-value">5</span>
                    <span>Muy alto</span>
                </div>

                <label>Cambios de Ánimo</label>
                <div style="margin-bottom: 0.8em;">
                    <label class="flex items-center mb-1">
                        <input type="radio" name="cambios_animo" value="Muy estable" class="checkbox-custom">Muy estable
                    </label>
                    <label class="flex items-center mb-1">
                        <input type="radio" name="cambios_animo" value="Cambios leves" class="checkbox-custom">Cambios leves
                    </label>
                    <label class="flex items-center mb-1">
                        <input type="radio" name="cambios_animo" value="Cambios moderados" class="checkbox-custom">Cambios moderados
                    </label>
                    <label class="flex items-center">
                        <input type="radio" name="cambios_animo" value="Muy inestable" class="checkbox-custom">Muy inestable
                    </label>
                </div>

                <label for="emocion_predominante">Emoción Predominante</label>
                <select id="emocion_predominante" name="emocion_predominante" class="form-input" required>
                    <option value="">Selecciona una emoción</option>
                    <option value="Tristeza">Tristeza</option>
                    <option value="Desánimo/Bajones">Desánimo/Bajones</option>
                    <option value="Irritabilidad">Irritabilidad</option>
                    <option value="Euforia">Euforia</option>
                    <option value="Ansiedad">Ansiedad</option>
                    <option value="Vacío">Vacío</option>
                    <option value="Estabilidad">Estabilidad</option>
                </select>

                <label for="evento_reflexion">Evento Relevante / Reflexión</label>
                <textarea id="evento_reflexion" name="evento_reflexion" rows="3" class="form-input" placeholder="¿Pasó algo significativo hoy o cómo te sientes?"></textarea>

                <button type="submit" class="btn-primary" id="submit-btn">
                    <i class="fas fa-paper-plane mr-2"></i>
                    Completar Bitácora
                </button>
            </form>

            <div id="status-message" class="hidden"></div>
        </div>

        <!-- Página de Recompensa -->
        <div id="reward-page" class="fade-in hidden">
            <div class="text-center">
                <div id="reward-message" class="text-xl font-medium text-gray-300 mb-6"></div>
                <div class="photo-container mb-6">
                    <img id="reward-photo" src="" alt="Foto de recuerdo">
                </div>
                <div class="text-2xl font-bold text-red-400 mb-6">
                    <i class="fas fa-heart mr-2"></i>
                    Te amamos hijito ❤️
                </div>
                <button id="new-entry-btn" class="btn-primary">
                    <i class="fas fa-plus mr-2"></i>
                    Nueva Bitácora
                </button>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-gray-800 p-6 rounded-lg text-center">
                <div class="loading mb-4"></div>
                <p class="text-gray-300">Cargando tu sorpresa...</p>
            </div>
        </div>
    </div>
</body>


    <script>
        class BitacoraMaxito {
            constructor() {
                this.fotos = [
                    'fotos/foto1.jpg',
                    'fotos/foto2.jpg',
                    'fotos/foto3.jpg',
                    'fotos/foto4.jpg',
                    'fotos/foto5.jpg',
                    'fotos/foto6.jpg',
                    'fotos/foto7.jpg',
                    'fotos/foto8.jpg',
                    'fotos/foto9.jpg',
                    'fotos/foto10.jpg',
                    'fotos/foto11.jpg',
                    'fotos/foto12.jpg',
                    'fotos/foto13.jpg',
                    'fotos/foto14.jpg',
                    'fotos/foto15.jpg'
                ];
                
                this.mensajes = [
                    "Mira qué pequeño eras...",
                    "¿Te acuerdas de este momento?",
                    "Qué hermoso recuerdo...",
                    "Esta sonrisa sigue ahí...",
                    "Momentos que no se olvidan...",
                    "Siempre fuiste especial...",
                    "Mira cuánto has crecido...",
                    "¿Recuerdas esta aventura?"
                ];
                
                this.makeWebhook = 'https://hook.us1.make.com/144onf1g776djfz608m6rl5pu7us4u37';
                this.init();
            }
            
            init() {
                this.setupFormSubmission();
                this.setupEnergySlider();
                this.setupNewEntryButton();
            }
            
            setupFormSubmission() {
                const form = document.getElementById('bitacora-form');
                if (form) {
                    form.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.procesarBitacora();
                    });
                }
            }
            
            setupEnergySlider() {
                const slider = document.getElementById('nivel_energia');
                const valueDisplay = document.getElementById('energia-value');
                
                if (slider && valueDisplay) {
                    slider.addEventListener('input', (e) => {
                        valueDisplay.textContent = e.target.value;
                    });
                }
            }
            
            setupNewEntryButton() {
                const newEntryBtn = document.getElementById('new-entry-btn');
                if (newEntryBtn) {
                    newEntryBtn.addEventListener('click', () => {
                        this.reiniciarFormulario();
                    });
                }
            }
            
            async procesarBitacora() {
                try {
                    // Mostrar loading
                    this.mostrarLoading(true);
                    
                    // Validar formulario
                    if (!this.validarFormulario()) {
                        this.mostrarLoading(false);
                        return;
                    }
                    
                    // Recoger y enviar datos
                    const formData = this.recogerDatos();
                    await this.enviarDatos(formData);
                    
                    // Mostrar sorpresa
                    setTimeout(() => {
                        this.mostrarLoading(false);
                        this.mostrarSorpresa();
                    }, 2000);
                    
                } catch (error) {
                    console.error('Error procesando bitácora:', error);
                    this.mostrarLoading(false);
                    this.mostrarMensaje('Error al procesar la bitácora. Inténtalo de nuevo.', 'error');
                }
            }
            
            validarFormulario() {
                const horasSueno = document.getElementById('horas_sueno').value;
                const cambiosAnimo = document.querySelector('input[name="cambios_animo"]:checked');
                const emocionPredominante = document.getElementById('emocion_predominante').value;
                
                if (!horasSueno) {
                    this.mostrarMensaje('Por favor, ingresa las horas de sueño.', 'error');
                    return false;
                }
                
                if (!cambiosAnimo) {
                    this.mostrarMensaje('Por favor, selecciona los cambios de ánimo.', 'error');
                    return false;
                }
                
                if (!emocionPredominante) {
                    this.mostrarMensaje('Por favor, selecciona la emoción predominante.', 'error');
                    return false;
                }
                
                return true;
            }
            
            recogerDatos() {
                const cambiosAnimo = document.querySelector('input[name="cambios_animo"]:checked');
                
                return {
                    fecha: new Date().toISOString().split('T')[0],
                    horas_sueno: document.getElementById('horas_sueno').value,
                    nivel_energia: document.getElementById('nivel_energia').value,
                    cambios_animo: cambiosAnimo ? cambiosAnimo.value : '',
                    emocion_predominante: document.getElementById('emocion_predominante').value,
                    evento_reflexion: document.getElementById('evento_reflexion').value,
                    timestamp: new Date().toISOString()
                };
            }
            
            async enviarDatos(datos) {
                try {
                    const response = await fetch(this.makeWebhook, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(datos)
                    });
                    
                    if (!response.ok) {
                        throw new Error('Error en el envío');
                    }
                    
                    console.log('Datos enviados correctamente');
                } catch (error) {
                    console.log('Error enviando datos:', error);
                    // No mostramos error al usuario para no interrumpir la experiencia
                }
            }
            
            mostrarSorpresa() {
                const fotoAleatoria = this.fotos[Math.floor(Math.random() * this.fotos.length)];
                const mensajeAleatorio = this.mensajes[Math.floor(Math.random() * this.mensajes.length)];
                
                document.getElementById('main-page').classList.add('hidden');
                document.getElementById('reward-page').classList.remove('hidden');
                document.getElementById('reward-message').textContent = mensajeAleatorio;
                document.getElementById('reward-photo').src = fotoAleatoria;
            }
            
            reiniciarFormulario() {
                // Limpiar formulario
                document.getElementById('bitacora-form').reset();
                document.getElementById('energia-value').textContent = '5';
                
                // Volver a la página principal
                document.getElementById('reward-page').classList.add('hidden');
                document.getElementById('main-page').classList.remove('hidden');
                
                // Limpiar mensajes
                this.ocultarMensaje();
            }
            
            mostrarLoading(mostrar) {
                const loadingOverlay = document.getElementById('loading-overlay');
                if (mostrar) {
                    loadingOverlay.classList.remove('hidden');
                } else {
                    loadingOverlay.classList.add('hidden');
                }
            }
            
            mostrarMensaje(mensaje, tipo) {
                const statusMessage = document.getElementById('status-message');
                statusMessage.textContent = mensaje;
                statusMessage.className = `mt-4 p-3 rounded-lg ${tipo === 'error' ? 'error-message' : 'success-message'}`;
                statusMessage.classList.remove('hidden');
                
                // Ocultar mensaje después de 5 segundos
                setTimeout(() => {
                    this.ocultarMensaje();
                }, 5000);
            }
            
            ocultarMensaje() {
                const statusMessage = document.getElementById('status-message');
                statusMessage.classList.add('hidden');
            }
        }

        // Inicializar cuando cargue la página
        document.addEventListener('DOMContentLoaded', () => {
            new BitacoraMaxito();
        });
    </script>
</body>
</html>
